<h1 class="text-center" >Customers geolocalisation</h1>

<div style='width: 800px;'>  
  <div id="map" style='width: 1200px; height: 800px;'></div>  
</div>  

<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=put_key_here&callback=initMap">
</script> 
   
  <script src="https://rawgit.com/kswedberg/jquery-smooth-scroll/master/jquery.smooth-scroll.js"></script>

          
<script>
          
     function initMap() {
         center_psn = {lat: 45.459467, lng: -73.567267};
         map = new google.maps.Map(document.getElementById('map'), {
         zoom : 5,
         center: center_psn,
        })
       
        <% @points_list.each_with_index do |lp| %>
            lat = <%= lp[:lat] %>
            long = <%= lp[:long] %>
            myLatLng = {lat: lat, lng: long}
            marker = new google.maps.Marker({
                    position: myLatLng,
                    map: map,
            })

            contentString = '<div id="content">'+
            '<div id="siteNotice">'+
            '</div>'+
            '<h1 id="firstHeading" class="firstHeading"> <%= lp[:name] %></h1>'+
            '<div id="bodyContent">'+
            '<p><b>Address: </b> <%= lp[:address] %></br>' +
           
            '</div>'+
            '</div>'

            marker.infowindow = new google.maps.InfoWindow({
            content: contentString
            
            })

            previous = false
            marker.addListener('click', function() {

                if(previous) {
                    previous.close()
                }
                previous = this.infowindow;
                this.infowindow.open(map, this);
            })

            
        <% end %>
       
       }
</script>